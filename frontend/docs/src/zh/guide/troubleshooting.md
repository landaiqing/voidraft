# 常见问题与故障排查

![故障排查占位](/img/placeholder-troubleshooting.png)
> 替换为错误提示或日志查看界面的截图。

## 安装与启动
| 问题 | 可能原因 | 解决步骤 |
| --- | --- | --- |
| 启动白屏 | WebView2 缺失或缓存损坏 | 安装 WebView2 Runtime；删除 `%APPDATA%/voidraft/Cache` 后重启 |
| 双击无反应 | 被安全策略拦截 | 以管理员运行或使用便携版；验证 SHA256 后加入白名单 |
| `wails3 dev` 报错 | Go/Node 版本不符或缺少 WebView2 | 确保 Go 1.21+、Node 18+，安装 WebView2 |

## 编辑器
| 问题 | 原因 | 解决 |
| --- | --- | --- |
| 格式化按钮灰色 | 当前块语言无对应 Prettier parser | 更换语言或安装支持的语言扩展（未来版本） |
| 块解析错误 | 分隔符格式不正确 | 确认 `∞∞∞language` 后跟换行；可用自动重建语法树命令 |
| 翻译浮层不出现 | 选区过短或超过最大长度 | 在设置 > 扩展 > translator 中调整阈值 |
| 小地图不同步 | 编辑器实例未刷新 | 切换文档或重开应用，检查扩展是否被禁用 |

## 窗口与多实例
| 问题 | 原因 | 解决 |
| --- | --- | --- |
| 子窗口未吸附 | WindowSnap 未启用 | 设置 > 通用 → 勾选“窗口吸附” |
| 全局热键无效 | 与系统/其他软件冲突 | 在设置 > 通用改用非系统占用组合，比如 `Ctrl+Alt+Space` |
| 关闭窗口直接退出 | 未启用托盘模式 | 设置 > 通用 → 启用系统托盘 |

## HTTP 客户端
| 问题 | 可能原因 | 解决 |
| --- | --- | --- |
| 发送失败，提示 `proxy` | 系统代理配置异常 | 在系统代理或环境变量中设置 HTTP(S)_PROXY，或关闭代理再试 |
| 响应乱码 | 服务器未声明编码 | 手动在请求头中加 `accept-charset: utf-8`，或在响应视图切换编码（计划） |
| 变量未替换 | 变量名拼写或作用域错误 | 确认 `@var` 定义位置，使用 `{{name}}` 语法 |

## 数据与备份
| 问题 | 可能原因 | 解决 |
| --- | --- | --- |
| 自动备份停在 “未初始化” | Repo URL/认证缺失 | 补全备份配置或关闭自动备份 |
| Push 失败 | Token 权限不足或网络问题 | 为 Token 开启 `repo` scope；检查代理；稍后再试 |
| 数据目录迁移后文件缺失 | 未重启或权限不足 | 修改 `dataPath` 后重启应用；确保目标目录可写 |

## 更新
| 问题 | 原因 | 解决 |
| --- | --- | --- |
| 检查更新超时 | 主源不可达 | 切换到备用源或关闭代理重试 |
| 下载完成但未重启 | 权限或文件被占用 | 以管理员运行，关闭杀毒软件后重试 |

## 收集日志
- Wails 日志：`%LOCALAPPDATA%/voidraft/logs/*.log`。
- 终端调试：运行 `wails3 dev` 并观察控制台输出。
- 若提交 Issue，请附上：系统版本、voidraft 版本、日志片段、复现步骤。

> 仍未解决？请到 GitHub Issues 提交反馈，并尽可能附上截图和日志。
